### 																					BTC 多签地址及隔离见证

#### 一.多签地址

节点钱包通过命令生成多签地址

```
./bitcoin-cli -rpcconnect=127.0.0.1 -rpcuser=bhp -rpcpassword=123456 -rpcport=8332 		addmultisigaddress 
  2 
  '''
    [
      "mjbLRSidW1MY8oubvs4SMEnHNFXxCcoehQ",
      "02ecd2d250a76d204011de6bc365a56033b9b3a149f679bc17205555d3c2b2854f",
      "mt17cV37fBqZsnMmrHnGCm9pM28R1kQdMG"
    ]
  ''' 
  'test account'
```

参数说明：

第一个参数  2  表示 Required：m-of-n解锁脚本需要的最少签名数量m，整数
第二个参数：KeysOrAddresses：可以参与签名的所有公钥数组，或者是钱包内P2PKH 地址数组 —— 从钱包内的P2PKH地址可以检索到对应的公钥（可传入地址或者公钥）
第三个参数：'test account' 表示Account： 生成的新地址要加入的钱包账户，可选，默认值为默认账户"" 

输出为对应的多签地址：

```
2MyVxxgNBk5zHRPRY2iVjGRJHYZEp1pMCSq
```

#### 二.隔离见证

1. **背景介绍：**

中本聪之前的代码中写到，在审核统计区块大小的时候，**每一个区块大小不超过1M**。

我们可以找到他在Github的代码提交：[中本聪对区块大小定义的源代码 （Github commitment)](https://link.zhihu.com/?target=https%3A//github.com/bitcoin/bitcoin/commit/a30b56ebe76ffff9f9cc8a6667186179413c6349)

![img](https://pic3.zhimg.com/80/v2-023775cf5764ca2169200bd2b4037dea_720w.jpg)

问题来了，在尽量使用现有的区块审核逻辑情况下如何缓解现在比特币拥堵问题？至于为什么要保持1M大小的区块，这里暂时不讨论，我们可以写另外一篇文章就**全节点**对于整个网络的**安全性**的重要性来谈谈。

2. **隔离见证做了什么改动？**

隔离见证就是把脚本签名(scriptSig)信息从基本结构 (base block) 里拿出来，放在一个新的数据结构当中。做验证工作的节点和矿工**也会验证这个新的数据结构里**的脚本签名，以确保交易是有效的。

那么重点来了：当审核统计区块大小不能超过1M的时候。脚本签大小不会被计算在内。

这简直是一个数学计算上的巧思！

3. **图说隔离见证**

下面我们来说一个非常浅显生动的例子，你瞬间就能明白了。

比如我们有一个交通法规，说一条大路上只能容许总面积是100单位面积的车辆。

每个车我们有30个单位的面积。大马路上一次只能跑3辆车。

![img](https://pic2.zhimg.com/80/v2-b3221a80716ebc237b75cda177dfba39_720w.jpg)

这时候把车的**结构重新调整下**，把拖车放到了顶上。每个车的面积单位变成了14个单位. 这时候大马路上一次能跑7辆车了。

![img](https://pic2.zhimg.com/80/v2-6b82f54a6831fb257c4c5545be37dae1_720w.jpg)

好我们现在把刚才浅显易懂的比喻换一下。**马路 = 1个区块 车 = 每一笔交易**

**问题1： 脚本签名是不是和每笔交易在一起？**

如图所释：车顶上的那个方块(脚本签名 ScripSig) 是属于车的一部分。**验证交易的时候签名当然会被一起验证。**

**问题2：见证是不是在区块链上？**

如图所释：只是改变了车的结构，而且整个车还是开在马路上。所以**当然在区块链里面！**

4. **程序员能看懂的图**

好了下面我们来深入的谈谈隔离见证是怎么具体用代码实现的吧：

隔离见证重新整理了每个交易内容的布局方式。把脚本签名从交易内容的结构里面拿出来，放到了最下面，并有一个指针Pointer指向它。

![img](https://pic3.zhimg.com/80/v2-baa5b80c2925939e9dd192c6ee26bf8e_720w.jpg)

**问题3 ：隔离见证技术成熟吗？**

隔离见证从提出到最后激活经历了数年时间，其实早在2016年1月21日就已经部署在测试网络了。到了2017年8月份才正式激活。技术已经相当成熟，但是从全部测试完毕到激活的过程又经历了很多争议。因为矿工的意见不能统一。

**问题4：为什么不直接用大区块？**

隔离见证 vs 大区块

其实这两个扩容方法都是可以采取，但是有一个**先后问题**。先后次序会很大程度影响到比特币的整个网络。那么为什么技术上要先上隔离见证，简单说来直接增大区块容量让下载全节点不适合于普通PC电脑，网络中越少的全节点其实不利于比特币安全。我们会用另外一篇文章讨论。至于大区块什么时候实施？ 到时候家用PC，宽带等技术都更新了。大多数人都能运行全节点。那时候上大区块也是很容易的事情。

隔离见证的其中一个好处是能缓解我们交易堵塞的问题。但是最重要的是为了闪电网络铺路。一种建立在比特币底层网络的智能合约。

**问题5：我理解了隔离见证，也很期待闪电网络。我现在可以做什么吗？**

新的交易，请用**隔离见证地址**。为比特币网络的拥堵缓解和未来发展贡献一份力量！

钱包地址开头为 1 的是老钱包，地址开头是 3 或者 bc1是Segwit钱包。如果更多人使用新版本钱包。那么会很好的解决网络堵塞的情况。

这里可以查阅，哪些交易所和钱包支持Segwit钱包地址。

[Segregated Witness Adoption](https://link.zhihu.com/?target=https%3A//bitcoincore.org/en/segwit_adoption/)

5.btc 地址区别

https://zhuanlan.zhihu.com/p/99933858

